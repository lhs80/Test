///<jscompress sourcefile="LSJPNode.js" />
LSJPNodeMat=function(){this.index=this.id=-1;this.imgUrl="";this.imgBlob=null;this.bUrl=!0;this.diffuseB=this.diffuseG=this.diffuseR=1};LSJPNodeMesh=function(){this.matIndex=-1;this.colors=this.normals=this.verts=this.indices=null;this.colorPerNum=1;this.uvs=[]};LSJPNode=function(){this.children=[];this.childRanges=[];this.strDataPath="";this.bdSphere=[];this.enRangeMode=0;this.arryMaterials=[];this.nodeMeshes=[]};LSJMemStream=function(a){this.curOffset=0;this.data=a;this.bLittleEndian=this.isLittleEndian()};LSJMemStream.prototype.constructor=LSJMemStream;LSJMemStream.prototype.TWO_POW_MINUS23=Math.pow(2,-23);LSJMemStream.prototype.TWO_POW_MINUS126=Math.pow(2,-126);LSJMemStream.prototype.isLittleEndian=function(){var a=new ArrayBuffer(2),b=new Uint8Array(a),a=new Uint16Array(a);b[0]=1;return 1===a[0]};LSJMemStream.prototype.readByte_1=function(){return this.data[this.curOffset++]&255};LSJMemStream.prototype.readUChar8_1=function(){return this.data[this.curOffset++]&255};LSJMemStream.prototype.readUInt32_1=function(){var a=this.readByte(),a=a|this.readByte()<<8,a=a|this.readByte()<<16;return a|this.readByte()<<24};LSJMemStream.prototype.readInt32_1=function(){var a=this.readByte(),a=a|this.readByte()<<8,a=a|this.readByte()<<16;return a|this.readByte()<<24};LSJMemStream.prototype.readFloat_1=function(){var a=this.readByte(),a=a+(this.readByte()<<8),b=this.readByte(),g=this.readByte(),a=a+((b&127)<<16),b=(g&127)<<1|(b&128)>>>7,g=g&128?-1:1;return 255===b?0!==a?NaN:Infinity*g:0<b?g*(1+a*this.TWO_POW_MINUS23)*Math.pow(2,b-127):0!==a?g*a*this.TWO_POW_MINUS126:0*g};LSJMemStream.prototype.readUChar8=function(){var a=new Uint8Array(this.data,this.curOffset,1);this.curOffset+=1;return a[0]};LSJMemStream.prototype.readUInt32=function(){var a=(new DataView(this.data,this.curOffset,4)).getUint32(0,!0);this.curOffset+=4;return a};LSJMemStream.prototype.readInt32=function(){var a=new DataView(this.data,this.curOffset,4);this.curOffset+=4;return a.getInt32(0,!0)};LSJMemStream.prototype.readInt16=function(){var a=new DataView(this.data,this.curOffset,2);this.curOffset+=2;return a.getInt16(0,!0)};LSJMemStream.prototype.readUInt16=function(){var a=new DataView(this.data,this.curOffset,2);this.curOffset+=2;return a.getUint16(0,!0)};LSJMemStream.prototype.readFloat=function(){var a=new DataView(this.data,this.curOffset,4);this.curOffset+=4;return a.getFloat32(0,!0)};LSJMemStream.prototype.readDouble=function(){var a=new DataView(this.data,this.curOffset,8);this.curOffset+=8;return a.getFloat64(0,!0)};LSJMemStream.prototype.readFloat32Array=function(a){a*=4;var b=new DataView(this.data,this.curOffset,a);this.curOffset+=a;return b};LSJMemStream.prototype.readFloat64Array=function(a){a*=8;var b=new DataView(this.data,this.curOffset,a);this.curOffset+=a;return b};LSJMemStream.prototype.readUInt16Array=function(a){a*=2;var b=new DataView(this.data,this.curOffset,a);this.curOffset+=a;return b};LSJMemStream.prototype.readUInt32Array=function(a){a*=4;var b=new DataView(this.data,this.curOffset,a);this.curOffset+=a;return b};LSJMemStream.prototype.readUChar8Array=function(a){a*=1;var b=new DataView(this.data,this.curOffset,a);this.curOffset+=a;return b};LSJMemStream.prototype.readUChar8Array2=function(a){var b=new Uint8Array(this.data,this.curOffset,a);this.curOffset+=a;return b};LSJMemStream.prototype.readString=function(){for(var a=this.readUInt32(),b=new Uint8Array(this.data,this.curOffset,a),g="",h=0;h<a;h++)g+=String.fromCharCode(b[h]);this.curOffset+=a;return g};LSJPParser=function(){};LSJPParser.prototype.constructor=LSJPParser;LSJPParser.prototype.parseMaterials=function(a,b){for(var g=b.readUInt32(),h=0;h<g;h++){var d=new LSJPNodeMat;d.index=h;d.id=h;a.arryMaterials.push(d);b.readUChar8Array2(4);var c=b.readUChar8Array2(4);b.readUChar8Array2(4);b.readFloat();d.diffuseR=c[0]/255;d.diffuseG=c[1]/255;d.diffuseB=c[2]/255;for(var c=b.readUInt32(),e=0;e<c;e++)if(0==b.readUInt32()){var f=b.readString(),l=b.readUInt32(),l=b.readUChar8Array2(l);if(0==e){var f=f.substring(f.lastIndexOf("."),f.length).toLowerCase(),k;".jpeg"==f||".jpg"==f?k="jpeg":".png"==f?k="png":".gif"==f?k="gif":".icon"==f&&(k="x-icon");d.imgBlob=new Blob([l],{type:k});d.bUrl=!1}}else f=b.readString(),0==e&&(d.imgUrl=f,d.bUrl=!0)}};LSJPParser.prototype.parseNode=function(a,b){for(var g=b.readUInt32(),h=0;h<g;h++){var d=b.readUInt32(),c=new LSJPNode;a.children.push(c);0==d?c.strDataPath=b.readString():this.parseNode(c,b)}a.enRangeMode=b.readUInt32();g=b.readUInt32();for(h=c=0;h<g;h++)a.childRanges.push(b.readDouble()),a.childRanges.push(b.readDouble());a.bdSphere.push(b.readDouble());a.bdSphere.push(b.readDouble());a.bdSphere.push(b.readDouble());a.bdSphere.push(b.readDouble());g=b.readUInt32();for(h=0;h<g;h++){d=new LSJPNodeMesh;a.nodeMeshes.push(d);d.matIndex=b.readUInt32();b.readUInt32();var e=b.readUInt32();if(0<e)if(c=b.readUInt32(),4==c){var f=b.readUInt32Array(e);d.indices=new Uint32Array(e);for(c=0;c<e;c++)d.indices[c]=f.getUint32(4*c,!0)}else if(2==c)for(f=b.readUInt16Array(e),d.indices=new Uint16Array(e),c=0;c<e;c++)d.indices[c]=f.getUint16(2*c,!0);c=b.readUInt32();if(0<c)for(e=3*c,f=b.readFloat32Array(e),d.verts=new Float32Array(e),c=0;c<e;c++)d.verts[c]=f.getFloat32(4*c,!0);c=b.readUInt32();if(0<c)for(e=3*c,f=b.readFloat32Array(e),d.normals=new Float32Array(e),c=0;c<e;c++)d.normals[c]=f.getFloat32(4*c,!0);for(var f=b.readUInt32(),l=0;l<f;l++)if(c=b.readUInt32(),0<c){for(var e=2*c,k=b.readFloat32Array(e),m=new Float32Array(e),c=0;c<e;c++)m[c]=k.getFloat32(4*c,!0);d.uvs.push(m)}c=b.readUInt32();if(0<c)for(e=c,f=b.readUInt32Array(e),d.colors=new Uint32Array(e),d.colorPerNum=1,c=0;c<e;c++)d.colors[c]=f.getUint32(c,!0);d=b.readUInt32();0<d&&(e=d,b.readUInt32Array(e))}};LSJPParser.prototype.parse=function(a,b){b.readUInt32();this.parseMaterials(a,b);this.parseNode(a,b)};